<?xml version="1.0"?>
<metadata xml:lang="en"><Esri><CreaDate>20220113</CreaDate><CreaTime>11325800</CreaTime><ArcGISFormat>1.0</ArcGISFormat><SyncOnce>TRUE</SyncOnce><ModDate>20220726</ModDate><ModTime>18244700</ModTime><scaleRange><minScale>150000000</minScale><maxScale>5000</maxScale></scaleRange><ArcGISProfile>ItemDescription</ArcGISProfile></Esri><tool name="SvcTool" displayname="Web Service Inventory" toolboxalias="webtoolbox" xmlns=""><arcToolboxHelpPath>c:\program files\arcgis\pro\Resources\Help\gp</arcToolboxHelpPath><parameters><param name="TemplateSpreadsheet" displayname="Template Spreadsheet for 'Pretty' Output" type="Required" direction="Input" datatype="File" expression="TemplateSpreadsheet"><dialogReference>&lt;DIV STYLE="text-align:Left;"&gt;&lt;DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN&gt;The formatted spreadsheet that will be updated with Portal or AGOL web services details.  Defaults to LaDOTD_WebServices_Autopopulate.xlsx in the same folder as the python toolbox script.&lt;/SPAN&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;</dialogReference><pythonReference>&lt;DIV STYLE="text-align:Left;"&gt;&lt;DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN&gt;The formatted spreadsheet that will be updated with Portal or AGOL web services details.  Defaults to LaDOTD_WebServices_Autopopulate.xlsx in the same folder as the python toolbox script.&lt;/SPAN&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN /&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;</pythonReference></param><param name="outdir" displayname="Output Folder for Text Files" type="Required" direction="Input" datatype="Folder" expression="outdir"><dialogReference>&lt;DIV STYLE="text-align:Left;"&gt;&lt;DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN&gt;Output folder for text files and a populated version of the .xlsx file.&lt;/SPAN&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;</dialogReference><pythonReference>&lt;DIV STYLE="text-align:Left;"&gt;&lt;DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN&gt;Output folder for text files and a populated version of the .xlsx file.&lt;/SPAN&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN /&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;</pythonReference></param><param name="ImportPortalDetails" displayname="Existing Portal Service Table" type="Optional" direction="Input" datatype="File" expression="{ImportPortalDetails}"><dialogReference>&lt;DIV STYLE="text-align:Left;"&gt;&lt;DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN&gt;Optional: Existing .txt file with portal service details, created either through a previous run with "Create New Portal Service Table and Load Data" checked, or created using the Portal Services inventory tool.  Adds links to service details to each web service tab.&lt;/SPAN&gt;&lt;/P&gt;&lt;P&gt;&lt;SPAN /&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;</dialogReference><pythonReference>&lt;DIV STYLE="text-align:Left;"&gt;&lt;DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN&gt;Optional: Existing .txt file with portal service details, created either through a previous run with "Create New Portal Service Table and Load Data" checked, or created using the Portal Services inventory tool.  Adds links to service details to each web service tab.&lt;/SPAN&gt;&lt;/P&gt;&lt;P&gt;&lt;SPAN /&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN /&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;</pythonReference></param><param name="GetPortalDetails" displayname="Create New Portal Service Table and Load Data" type="Optional" direction="Input" datatype="Boolean" expression="{GetPortalDetails}"><dialogReference>&lt;DIV STYLE="text-align:Left;"&gt;&lt;DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN&gt;Optional: Run the Portal Services inventory tool using the active portal in the current ArcGIS Pro instance.  Adds links to service details to each web service tab.  &lt;/SPAN&gt;&lt;/P&gt;&lt;P&gt;&lt;SPAN /&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;</dialogReference><pythonReference>&lt;DIV STYLE="text-align:Left;"&gt;&lt;DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN&gt;Optional: Run the Portal Services inventory tool using the active portal in the current ArcGIS Pro instance.  Adds links to service details to each web service tab.  &lt;/SPAN&gt;&lt;/P&gt;&lt;P&gt;&lt;SPAN /&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;</pythonReference></param><param name="Port" displayname="Port" type="Optional" direction="Input" datatype="Any Value" expression="{Port}"><dialogReference>&lt;DIV STYLE="text-align:Left;"&gt;&lt;DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN&gt;When running outside of ArcGIS Pro, pass a portal object to this script to inventory the portal.&lt;/SPAN&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;</dialogReference><pythonReference>&lt;DIV STYLE="text-align:Left;"&gt;&lt;DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN&gt;When running outside of ArcGIS Pro, pass a portal object to this script to inventory the portal.&lt;/SPAN&gt;&lt;/P&gt;&lt;P&gt;&lt;SPAN /&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;</pythonReference></param></parameters><summary>&lt;DIV STYLE="text-align:Left;"&gt;&lt;DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN&gt;Inventory services in ArcGIS Online or Portal.  Optionally link to Portal service details including service status, data stores, and databases.  When accessed from ArcGIS Pro, this tool uses the credentials and AGOL or Portal environment of the active ArcGIS Pro session.  Outside of ArcGIS Pro, a portal object can be passed to the tool.&lt;/SPAN&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;</summary><scriptExamples><scriptExample><title>Create Web Services Report (stand-alone script)</title><para>&lt;DIV STYLE="text-align:Left;"&gt;&lt;DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN&gt;The following code shows how to use the Web Services Inventory outside of ArcGIS Pro.&lt;/SPAN&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;</para><code>#Import the required GIS modules
import arcpy, arcgis

arcpy.ImportToolbox("C:/temp/WebInventoryToolboxForOutsideOfPro.pyt")

#Log into the desired portal (the higher the user's permissions 
#    on the portal, the more comprehensive the inventory)
gisportal = arcgis.gis.GIS("https://maps.agency.gov/portal", 
    "myusername", "mypassword")

#Run the code with an existing portal service inventory table.
arcpy.webtoolbox.SvcTool(r"C:\Temp\WebServices_Autopopulate.xlsx", 
    "C:/Temp/OutputFolder", r"C:\Temp\servicesinventory_07-06-2022_0210_PM.txt", 
    None, gisportal)

#Alternatively, generate a detailed service inventory table along 
#    with the Web Services Inventory for the portal specified by the 
#    "gisportal" variable above.
arcpy.webtoolbox.SvcTool(r"C:\Temp\WebServices_Autopopulate.xlsx", 
    "C:/Temp/OutputFolder", None, True, gisportal)</code></scriptExample></scriptExamples><scriptExamples><scriptExample><title>Create Web Services Report (Python window)</title><para>&lt;DIV STYLE="text-align:Left;"&gt;&lt;DIV&gt;&lt;DIV&gt;&lt;P&gt;&lt;SPAN&gt;The following code shows how to use the Web App Inventory within ArcGIS Pro.  The script demonstrates using the tool for AGOL, but it can also be used when logged into a Portal.  If the user is logged into a Portal in ArcGIS Pro, the portal services table can also be included or generated for greater detail.  Similar functionality is not yet available for AGOL.&lt;/SPAN&gt;&lt;/P&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;</para><code>#Run the script for AGOL (this doesn't support generating or using a portal services table).
#Log into an AGOL active portal in ArcGIS Pro before running the script
arcpy.webtoolbox.SvcTool(r"C:\Temp\WebServices_Autopopulate.xlsx", 
    "C:/Temp/OutputFolder", None, None)

#Alternatively, set an agency Portal as the active portal in ArcGIS Pro before running the script and either provide or generate a detailed service inventory table.
arcpy.webtoolbox.SvcTool(r"C:\Temp\WebServices_Autopopulate.xlsx", 
    "C:/Temp/OutputFolder", None, True)

</code></scriptExample></scriptExamples></tool><dataIdInfo><idCitation><resTitle>Web Service Inventory</resTitle></idCitation><searchKeys><keyword>Portal; AGOL</keyword></searchKeys></dataIdInfo><distInfo><distributor><distorFormat><formatName>ArcToolbox Tool</formatName></distorFormat></distributor></distInfo><mdHrLv><ScopeCd value="005"/></mdHrLv><mdDateSt Sync="TRUE">20220726</mdDateSt></metadata>
